setwd("~/Magistrale/PSAST/co2_mauna_loa")
co2_data <- read.csv("./co2_mm_mlo.csv", sep=",", comment.char="#")
co2_values <- co2_data$average
starting_year <- co2_data$year[1]
starting_month <- co2_data$month[1]
co2_ts <- ts(co2_values, start=c(starting_year, starting_month), frequency=12)
plot(co2_ts, type="l", ylab="", xlab="t", main="Concentrazione CO2")
par(mfrow=c(2,1))
acf(co2_ts, lag.max=36, main="ACF campionaria concentrazione CO2")
pacf(co2_ts, lag.max=36, main="PACF campionaria concentrazione CO2")
co2_detr <- diff(co2_ts, lag=1, differences=2)
lag.plot(co2_detr, set.lags=1:12, type="p", do.lines=FALSE)
co2_detr_dest <- diff(co2_detr, lag=12, differences=1)
plot(co2_detr_dest)
Box.test(co2_detr_dest, lag=20, type="Ljung-Box")
co2_detr <- diff(co2_ts, lag=1, differences=3)
co2_detr_dest <- diff(co2_detr, lag=12, differences=1)
plot(co2_detr_dest)
co2_detr <- diff(co2_ts, lag=1, differences=4)
lag.plot(co2_detr, set.lags=1:12, type="p", do.lines=FALSE)
co2_detr_dest <- diff(co2_detr, lag=12, differences=1)
plot(co2_detr_dest)
co2_detr <- diff(co2_ts, lag=1, differences=5)
lag.plot(co2_detr, set.lags=1:12, type="p", do.lines=FALSE)
